run:
  timeout: 5m
  tests: true
  modules-download-mode: readonly
  go: '1.23'

linters:
  enable:
    - errcheck        # Check for unchecked errors
    - gosimple        # Simplify code
    - govet           # Go vet checks
    - ineffassign     # Detect ineffectual assignments
    - staticcheck     # Static analysis
    - unused          # Detect unused code
    - gofmt           # Check formatting
    - goimports       # Check imports
    - misspell        # Spell checker
    - revive          # Drop-in replacement for golint
    - gosec           # Security checker
    - noctx           # HTTP requests should use context
    - gocyclo         # Cyclomatic complexity
    - typecheck       # Type checking
    - goconst         # Repeated strings that should be constants
    - unconvert       # Unnecessary type conversions
    - unparam         # Unused function parameters
    - nakedret        # Naked returns in long functions

linters-settings:
  gocyclo:
    min-complexity: 20
  
  gosec:
    excludes:
      - G115  # Integer overflow conversions (false positives for bounded values)
      - G304  # File path from variable (acceptable in CLI tools)
      - G306  # WriteFile permissions (0644 is fine for reports)
      - G404  # Use of weak random number generator (we use crypto/rand)
  
  errcheck:
    check-type-assertions: false
    check-blank: false
  
  govet:
    enable-all: true
    disable:
      - shadow          # Too many false positives in tests
      - fieldalignment  # Optimization suggestions, not bugs
  
  revive:
    rules:
      - name: exported
        arguments:
          - "checkPrivateReceivers"
          - "sayRepetitiveInsteadOfStutters"
  
  nakedret:
    max-func-lines: 30

issues:
  exclude-use-default: false
  max-issues-per-linter: 0
  max-same-issues: 0
  
  exclude-rules:
    # Exclude some linters from running on tests files
    - path: _test\.go
      linters:
        - gocyclo
        - errcheck
        - gosec
        - goconst
        - unparam
    
    # Exclude test helpers from documentation requirements
    - path: test_helpers\.go
      linters:
        - revive
        - errcheck
    
    # Exclude twins test infrastructure from strict linting
    - path: twins/
      linters:
        - revive
        - errcheck
        - goconst
    
    # Exclude bench tools from strict linting
    - path: bench/
      linters:
        - gocyclo
        - goconst
    
    # Exclude demo visualization from strict linting
    - path: demo/
      linters:
        - revive
        - errcheck
        - gosec
        - goconst
    
    # Exclude known false positives
    - text: "G404:"  # Weak random in tests is okay
      path: _test\.go
      linters:
        - gosec

output:
  print-issued-lines: true
  print-linter-name: true
  sort-results: true
